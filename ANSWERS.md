# 🔑 CASPER CTF 2026 - 정답지

> ⚠️ **주의**: 이 파일은 문제 출제자 및 운영진용입니다. 참가자에게 공개하지 마세요!

---

## 📋 개요

- **총 방 개수**: 7개
- **제한시간**: 45분
- **힌트 페널티**: 힌트 사용 시 +2분
- **평가 등급**:
  - S+: 30분 이하, 힌트 0개
  - A: 35분 이하
  - B: 45분 이하
  - C: 45분 초과

---

## 방 1: 침해 로그 분석 🔍

**주제**: 공격 패턴 식별, 킬체인 추적

### 정답

| 질문 | 정답 |
|------|------|
| **Q1**: 공격자 IP 주소 | `10.0.14.33` |
| **Q2**: 사용된 공격 기법 | `sql injection` |
| **Q3**: 업로드된 웹셸 파일명 | `sh3ll.php` |
| **Q4**: 리버스 쉘 포트 번호 | `4444` |
| **Q5**: 지속성 확보 방법 | `crontab` |

### 해설
- 로그를 분석하여 SQL Injection 공격 → 웹셸 업로드 → 리버스 쉘 연결 → crontab 등록의 공격 흐름을 파악
- 전형적인 웹 해킹 킬체인

---

## 방 2: 메모리 포렌식 💾

**주제**: 프로세스 트리 분석, C2 서버 식별

### 정답

| 질문 | 정답 |
|------|------|
| **Q1**: 악성 프로세스 PID (복수 선택) | `891`, `892`, `1337` |
| **Q2**: 초기 침투 경로 | `웹셸 경유` |
| **Q3**: C2 서버 주소 | `45.33.32.156:8443` |
| **Q4**: 의심스러운 이유 (복수 선택) | `비정상적 경로`, `높은 리소스` |

### 해설
- 프로세스 트리에서 비정상적인 부모-자식 관계 파악
- 웹셸(sh3ll.php)에서 시작된 프로세스 체인 추적
- 네트워크 연결을 통해 C2 서버 식별

---

## 방 3: 암호 해독실 🔐

**주제**: 암호학 취약점 분석 (ECB, Padding Oracle, PBKDF2)

### 정답

| 질문 | 정답 |
|------|------|
| **QA**: 취약한 블록 암호화 모드 | `모드 1 (ECB)` |
| **QB**: 암호문 변조 공격 기법 | `padding oracle` 또는 `padding oracle attack` |
| **QC**: PBKDF2 취약점 공격 방법 | `사전 공격 (Dictionary Attack)` 또는 `사전 공격` |

### 해설
- ECB 모드는 같은 평문 블록이 같은 암호문을 생성하는 취약점
- Padding Oracle Attack은 암호화 패딩 검증 오류를 이용한 공격
- 약한 비밀번호는 사전 공격에 취약

---

## 방 4: 취약점 분석실 🐛

**주제**: OWASP Top 10, 시큐어 코딩

### 정답

| 질문 | 정답 |
|------|------|
| **Q1**: 코드 A의 취약점 | `SQL Injection` |
| **Q2**: 코드 B의 취약점 | `XSS` |
| **Q3**: 코드 C의 취약점 | `CSRF` |
| **Q4**: 코드 D의 취약점 | `Insecure Deserialization` |

### 해설
- SQL Injection: 사용자 입력을 직접 쿼리에 삽입
- XSS: 사용자 입력을 필터링 없이 HTML에 출력
- CSRF: 요청 검증 토큰 없음
- Insecure Deserialization: 신뢰할 수 없는 데이터 역직렬화

---

## 방 5: 네트워크 침투 🌐

**주제**: 방화벽 ACL, 공격 경로 설계

### 정답

| 질문 | 정답 |
|------|------|
| **Step 1**: 첫 번째 침투 대상 | `웹서버` |
| **Step 2**: 두 번째 침투 대상 | `DB서버` |
| **Step 3**: 세 번째 침투 대상 | `관리자PC` |
| **Step 4**: 최종 침투 대상 | `백업서버` |
| **Q2**: 가장 의심스러운 규칙 | `DB서버에서 관리자PC로의 비정상 연결` |

### 정답 경로
```
Internet → 웹서버(443) → DB서버(3306) → 관리자PC → 백업서버(22)
```

### 해설
- 방화벽 규칙을 분석하여 허용된 경로를 따라 피벗팅
- DB 서버에서 관리자 PC로의 연결은 정상적이지 않음 (보통 반대 방향)

---

## 방 6: 악성코드 행위 분석 🦠

**주제**: 동적 분석, MITRE ATT&CK

### 정답

| 질문 | 정답 |
|------|------|
| **Q1**: 악성코드 유형 | `Ransomware` |
| **Q2**: 지속성 확보 방법 | `레지스트리 Run 키` |
| **Q3 - 도메인**: C2 도메인 | `hidden.evil.com` |
| **Q3 - 기법**: 은닉 기법 | `DNS 터널링` |
| **Q4**: 랜섬웨어 추가 공격 | `백업 복원 불가능` |
| **Q5**: MITRE ATT&CK 전술 | `Persistence` |

### 해설
- Base64로 인코딩된 명령어를 디코딩하여 분석
- 레지스트리 Run 키를 통한 재부팅 후 자동 실행
- DNS 터널링을 통한 C2 통신 은닉
- Shadow Copy 삭제로 백업 복원 방지

---

## 방 7: 최종 대응 (IR 종합) 🎯

**주제**: 킬체인 재구성, 인시던트 대응 우선순위

### 정답

#### Part 1: 킬체인 순서 (드래그 앤 드롭)

올바른 순서:
1. 정찰 (Reconnaissance)
2. 무기화 (Weaponization)
3. 전달 (Delivery)
4. 취약점 공격 (Exploitation)
5. 설치 (Installation)
6. C2 연결 (Command & Control)
7. 내부 정찰 (Internal Recon)
8. 횡적 이동 (Lateral Movement)
9. 목적 달성 (Actions on Objectives)
10. 데이터 유출 (Exfiltration)

#### Part 2: 대응 우선순위

| 순위 | 조치 | 답 |
|------|------|-----|
| **1순위** | 감염 시스템 네트워크 격리 | `e` |
| **2순위** | C2 서버 IP 차단 | `b` |
| **3순위** | 백도어/웹셸 제거 | `g` |

### 해설
- 킬체인은 공격자의 공격 단계를 시간순으로 재구성
- 대응 우선순위:
  1. 격리: 추가 피해 확산 방지
  2. C2 차단: 공격자의 제어 차단
  3. 백도어 제거: 재침투 방지

---

## 🎓 교육 포인트

### Room 1-2: 초기 침투 탐지
- 로그 분석 능력
- 공격 패턴 인식
- 메모리 포렌식 기초

### Room 3-4: 취약점 이해
- 암호학 취약점
- 웹 애플리케이션 보안
- OWASP Top 10

### Room 5-6: 고급 분석
- 네트워크 세그멘테이션
- 공격 경로 분석
- 악성코드 동적 분석

### Room 7: 종합 대응
- 킬체인 이해
- 인시던트 대응 우선순위
- 전체적인 사고 대응 프로세스

---

## 📊 성적 산출 방법

```javascript
// JavaScript 코드에서 자동 계산
const elapsed = getElapsedTime(); // 경과 시간 (초)
const hints = parseInt(localStorage.getItem('hintsUsed') || '0');

// 점수 = 경과시간 + (힌트 수 × 120초)
const score = elapsed + (hints * 120);

// 등급 계산
if (score <= 1800 && hints === 0) return 'S+'; // 30분 이하, 힌트 없음
if (score <= 2100) return 'A'; // 35분
if (score <= 2700) return 'B'; // 45분
return 'C'; // 45분 초과
```

---

## 🎯 운영 팁

1. **사전 준비**
   - 참가자들에게 모바일 기기 충전 안내
   - Wi-Fi 환경 확인
   - 힌트 시스템 설명

2. **진행 중**
   - 타이머가 작동하는지 확인
   - 참가자들이 힌트 페널티를 이해하고 있는지 확인
   - 문제가 있으면 localStorage.clear()로 초기화

3. **종료 후**
   - 성적 확인 (브라우저 개발자 도구 → localStorage)
   - 우수 참가자 시상
   - 풀이 해설 세션

---

## ⚙️ 관리자 명령어

브라우저 개발자 도구 콘솔에서:

```javascript
// 진행 상황 확인
console.log('시작 시간:', new Date(parseInt(localStorage.gameStartTime)));
console.log('경과 시간:', getElapsedTime(), '초');
console.log('힌트 사용:', localStorage.hintsUsed);
console.log('통과한 방:', localStorage.clearedRooms);

// 게임 초기화
localStorage.clear();

// 특정 방으로 강제 이동 (디버깅용)
localStorage.clearedRooms = JSON.stringify([1, 2, 3]);
window.location.href = 'room4.html';

// 성적 확인
console.log('등급:', calculateGrade());
```

---

**제작**: CASPER 동아리  
**버전**: 2026  
**난이도**: 중급~고급 (졸업생 및 현직 보안 전문가 대상)

🎉 **즐거운 MT 되세요!**
