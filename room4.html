<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°© 4 - ì·¨ì•½ì  ë¶„ì„ì‹¤ | CASPER CTF 2026</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">ğŸ” CASPER CTF</div>
            <div class="timer" id="timer">00:00</div>
        </div>
    </div>

    <div class="container">
        <div class="progress-container">
            <div class="progress-header">
                <span class="progress-text" id="progress-text">ë°© 4/7</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 57.12%;"></div>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ› ë°© 4 â€” ì·¨ì•½ì  ë¶„ì„ì‹¤</h2>
            <p style="color: #aaa; margin-bottom: 20px;">
                ë‹¤ìŒ Python ì½”ë“œ ìŠ¤ë‹ˆí«ë“¤ì„ ê²€í† í•˜ê³ , ê°ê°ì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ ì‹ë³„í•˜ì„¸ìš”.
            </p>
        </div>

        <!-- Code 1: SQL Injection -->
        <div class="card">
            <h3>ğŸ’» ì½”ë“œ 1</h3>
            <div class="code-block">
<pre>def login(request):
    user = request.POST['username']
    pw = request.POST['password']
    query = f"SELECT * FROM users WHERE name='{user}' AND pw='{pw}'"
    db.execute(query)</pre>
            </div>
            <div class="question">
                <label>ì·¨ì•½ì  ìœ í˜•:</label>
                <select id="q1">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="SQL Injection">SQL Injection</option>
                    <option value="XSS">XSS</option>
                    <option value="CSRF">CSRF</option>
                    <option value="SSRF">SSRF</option>
                    <option value="Insecure Deserialization">Insecure Deserialization</option>
                    <option value="Path Traversal">Path Traversal</option>
                    <option value="Command Injection">Command Injection</option>
                    <option value="XXE">XXE</option>
                </select>
            </div>
        </div>

        <!-- Code 2: XSS -->
        <div class="card">
            <h3>ğŸ’» ì½”ë“œ 2</h3>
            <div class="code-block">
<pre>def profile(request):
    bio = request.GET['bio']
    return HttpResponse(f"&lt;div class='bio'&gt;{bio}&lt;/div&gt;")</pre>
            </div>
            <div class="question">
                <label>ì·¨ì•½ì  ìœ í˜•:</label>
                <select id="q2">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="SQL Injection">SQL Injection</option>
                    <option value="XSS">XSS</option>
                    <option value="CSRF">CSRF</option>
                    <option value="SSRF">SSRF</option>
                    <option value="Insecure Deserialization">Insecure Deserialization</option>
                    <option value="Path Traversal">Path Traversal</option>
                    <option value="Command Injection">Command Injection</option>
                    <option value="XXE">XXE</option>
                </select>
            </div>
        </div>

        <!-- Code 3: CSRF -->
        <div class="card">
            <h3>ğŸ’» ì½”ë“œ 3</h3>
            <div class="code-block">
<pre>def transfer(request):
    to = request.POST['to']
    amount = request.POST['amount']
    # ì‚¬ìš©ì ì¸ì¦ì€ ì„¸ì…˜ ì¿ í‚¤ë¡œ ìë™ ì²˜ë¦¬ë¨
    process_transfer(request.user, to, amount)</pre>
            </div>
            <div class="question">
                <label>ì·¨ì•½ì  ìœ í˜•:</label>
                <select id="q3">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="SQL Injection">SQL Injection</option>
                    <option value="XSS">XSS</option>
                    <option value="CSRF">CSRF</option>
                    <option value="SSRF">SSRF</option>
                    <option value="Insecure Deserialization">Insecure Deserialization</option>
                    <option value="Path Traversal">Path Traversal</option>
                    <option value="Command Injection">Command Injection</option>
                    <option value="XXE">XXE</option>
                </select>
            </div>
        </div>

        <!-- Code 4: Insecure Deserialization -->
        <div class="card">
            <h3>ğŸ’» ì½”ë“œ 4</h3>
            <div class="code-block">
<pre>import pickle, base64

def load_settings(request):
    data = request.COOKIES.get('settings')
    return pickle.loads(base64.b64decode(data))</pre>
            </div>
            <div class="question">
                <label>ì·¨ì•½ì  ìœ í˜•:</label>
                <select id="q4">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="SQL Injection">SQL Injection</option>
                    <option value="XSS">XSS</option>
                    <option value="CSRF">CSRF</option>
                    <option value="SSRF">SSRF</option>
                    <option value="Insecure Deserialization">Insecure Deserialization</option>
                    <option value="Path Traversal">Path Traversal</option>
                    <option value="Command Injection">Command Injection</option>
                    <option value="XXE">XXE</option>
                </select>
            </div>
        </div>

        <div class="card">
            <div class="feedback hidden" id="feedback"></div>

            <div class="text-center mt-20">
                <button id="submit-btn" class="btn">ì œì¶œ</button>
            </div>
        </div>

        <div class="card hint-section">
            <h3>ğŸ’¡ íŒíŠ¸</h3>
            <button class="hint-btn btn-secondary">íŒíŠ¸ 1 ë³´ê¸° (+2ë¶„)</button>
            <div class="hint-text hidden" id="hint-1">
                <strong>íŒíŠ¸:</strong> 
                - ì½”ë“œ 1: f-stringìœ¼ë¡œ SQL ì¿¼ë¦¬ë¥¼ ì§ì ‘ êµ¬ì„±í•˜ë©´ ì‚¬ìš©ì ì…ë ¥ì´ ì¿¼ë¦¬ êµ¬ì¡°ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                - ì½”ë“œ 2: ì‚¬ìš©ì ì…ë ¥ì„ HTMLì— ì§ì ‘ ì‚½ì…í•˜ë©´ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </div>
            <button class="hint-btn btn-secondary">íŒíŠ¸ 2 ë³´ê¸° (+2ë¶„)</button>
            <div class="hint-text hidden" id="hint-2">
                <strong>íŒíŠ¸:</strong> 
                - ì½”ë“œ 3: CSRF í† í° ì—†ì´ ì„¸ì…˜ë§Œìœ¼ë¡œ ì¸ì¦í•˜ë©´ ì™¸ë¶€ ì‚¬ì´íŠ¸ì—ì„œ ìš”ì²­ì„ ìœ„ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                - ì½”ë“œ 4: pickle.loads()ëŠ” ì•…ì˜ì ì¸ ê°ì²´ë¥¼ ì—­ì§ë ¬í™”í•˜ë©´ ì„ì˜ ì½”ë“œ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </div>
        </div>
    </div>

    <script src="js/common.js"></script>
    <script src="js/room4.js"></script>
</body>
</html>
